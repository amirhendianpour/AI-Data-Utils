# تشخیص اشیاء و استخراج مختصات برای YOLO با OpenCV

[🇬🇧 English](README.md) | [🇮🇷 فارسی](README.fa.md)

این پروژه یک اسکریپت پایتون است که با استفاده از کتابخانه OpenCV، اشیاء موجود در یک تصویر را تشخیص داده، مستطیل‌هایی دور آن‌ها رسم می‌کند و مختصات نسبی آن‌ها را در فرمت مورد نیاز برای مدل YOLO ذخیره می‌کند.

## پیش‌نیازها

برای اجرای این کد، نیاز به نصب موارد زیر دارید:

- Python 3.x
- OpenCV (`opencv-python`)
- NumPy (به صورت پیش‌فرض همراه OpenCV نصب می‌شود)

### نصب پیش‌نیازها
دستور زیر را در ترمینال یا خط فرمان اجرا کنید:
```bash
pip install opencv-python
```

## نحوه کار کد

1. **ورودی**: یک تصویر با فرمت JPG (در این کد، فایل `3.jpg` به عنوان ورودی در نظر گرفته شده است).
2. **پردازش**:
   - تصویر به سیاه و سفید تبدیل می‌شود تا تشخیص حاشیه‌ها بهتر انجام شود.
   - با استفاده از آستانه‌گذاری (Thresholding)، حاشیه‌های اشیاء استخراج می‌شوند.
   - مستطیل‌های احاطه‌کننده (Bounding Boxes) دور اشیاء رسم می‌شوند.
3. **فیلتر کردن**:
   - اشیاء خیلی کوچک (کمتر از 1% مساحت تصویر) و خیلی بزرگ (بیش از 90% مساحت تصویر) نادیده گرفته می‌شوند.
4. **خروجی**:
   - تصویر نهایی با مستطیل‌های سبز دور اشیاء نمایش داده می‌شود.
   - مختصات نسبی اشیاء در فایل `coordinates.txt` به فرمت YOLO ذخیره می‌شود.

## ساختار فایل خروجی (`coordinates.txt`)
مختصات در فرمت زیر ذخیره می‌شوند که برای مدل YOLO مناسب است:
```
<class_id> <x_center> <y_center> <width> <height>
```
- `<class_id>`: شناسه کلاس (در این کد به صورت پیش‌فرض 0 در نظر گرفته شده است).
- `<x_center>` و `<y_center>`: مختصات مرکزی مستطیل نسبی به عرض و ارتفاع تصویر.
- `<width>` و `<height>`: عرض و ارتفاع نسبی مستطیل.

مثال:
```
0 0.45 0.50 0.20 0.30
```

## نحوه اجرا

1. تصویر مورد نظر خود را (مثلاً `3.jpg`) در همان پوشه‌ای که اسکریپت قرار دارد ذخیره کنید.
2. کد را اجرا کنید:
   ```bash
   python script.py
   ```
3. تصویر خروجی با مستطیل‌های تشخیص‌داده‌شده نمایش داده می‌شود. برای بستن پنجره، یک کلید را فشار دهید.
4. فایل `coordinates.txt` در همان پوشه ایجاد می‌شود.

## نکات مهم
- مسیر فایل تصویر (`image_path`) را بر اساس نیاز خود تغییر دهید.
- آستانه حداقل مساحت (`min_area`) و حداکثر مساحت (90% تصویر) قابل تنظیم هستند.
- در صورت بروز خطا (مثلاً پیدا نشدن تصویر)، پیام خطا نمایش داده می‌شود.

## رفع خطاها
- **خطای "تصویر پیدا نشد"**: مطمئن شوید فایل `3.jpg` در پوشه صحیح قرار دارد.
- **ماژول cv2 پیدا نشد**: OpenCV را با دستور `pip install opencv-python` نصب کنید.

## توسعه آینده
- افزودن امکان تعیین کلاس‌های مختلف برای اشیاء.
- پشتیبانی از ورودی‌های چندگانه (پوشه‌ای از تصاویر).
- بهبود فیلتر کردن اشیاء با استفاده از الگوریتم‌های پیشرفته‌تر.

## نویسنده
این کد توسط **امیر هندیان پور** نوشته شده است. برای سوالات یا پیشنهادات، با من تماس بگیرید!
